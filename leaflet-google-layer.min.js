!function s(r,l,a){function u(t,e){if(!l[t]){if(!r[t]){var o="function"==typeof require&&require;if(!e&&o)return o(t,!0);if(h)return h(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var n=l[t]={exports:{}};r[t][0].call(n.exports,function(e){return u(r[t][1][e]||e)},n,n.exports,s,r,l,a)}return l[t].exports}for(var h="function"==typeof require&&require,e=0;e<a.length;e++)u(a[e]);return u}({1:[function(e,o,t){(function(e){var r="undefined"!=typeof window?window.L:void 0!==e?e.L:null,t=["roadmap","satellite"];r.TileLayer.Google=r.TileLayer.extend({options:{GoogleTileAPIKey:null,imagery:"roadmap",language:"en-GB",region:"gb",mapStyle:[],requestTimeout:64e3},statics:{TILE_REQUEST:"https://www.googleapis.com/tile/v1/tiles/{z}/{x}/{y}?session={sessionToken}&orientation=0&key={GoogleTileAPIKey}",ATTRIBUTION_URL:"https://www.googleapis.com/tile/v1/viewport?session={sessionToken}&zoom={zoom}&north={north}&south={south}&east={east}&west={west}&key={GoogleTileAPIKey}",SESSION_TOKEN_URL:"https://www.googleapis.com/tile/v1/createSession?key={GoogleTileAPIKey}"},_getSessionToken:function(){var s=this;return this._exponentialBackoff||(this._exponentialBackoff=1e3),this._promise||(this._promise=new Promise(function(t,o){var e=r.Util.template(r.TileLayer.Google.SESSION_TOKEN_URL,{GoogleTileAPIKey:s.options.GoogleTileAPIKey}),i=JSON.stringify({mapType:s.options.imagery,language:s.options.language,region:s.options.region,overlay:!0,scale:"scaleFactor1x",styles:s.options.mapStyle}),n=new XMLHttpRequest;n.open("POST",e,!0),n.setRequestHeader("Content-type","application/json"),n.onreadystatechange=function(){if(clearTimeout(s._timer),4===this.readyState)if(200===this.status){s._exponentialBackoff=null;var e=JSON.parse(n.responseText);s._sessionToken=e.session,t(e)}else s._exponentialBackoff>s.options.requestTimeout?o("Session request failed.  Last request took more than "+s.options.requestTimeout/1e3+" seconds. Giving up."):(s._timer=setTimeout(function(){s._promise=null,s._exponentialBackoff*=2,s._getSessionToken().catch(function(e){console.log(e)})},s._exponentialBackoff),o("Session request failed, trying again in "+s._exponentialBackoff/1e3+"seconds"))},n.send(i)})),this._promise},_refreshToken:function(){var t=this;this._getSessionToken().then(function(e){setTimeout(function(){t._needToRefreshToken&&(t._promise=null,t._refreshToken())},1e3*e.expiry-(new Date).getTime()-36e5)}).catch(function(e){console.error("refreshToken",e)})},initialize:function(e){if(!e||!e.GoogleTileAPIKey)throw new Error("Must supply options.GoogleTileAPIKey");if(e=r.setOptions(this,e),t.indexOf(e.imagery)<0)throw new Error("'"+e.imagery+"' is an invalid mapType");this._sessionToken=null,this._needToRefreshToken=!1,this._promise=null,r.Browser.android||this.on("tileunload",this._onTileRemove)},createTile:function(t,o){var i=document.createElement("img");return r.DomEvent.on(i,"load",r.bind(this._tileOnLoad,this,o,i)),r.DomEvent.on(i,"error",r.bind(this._tileOnError,this,o,i)),this.options.crossOrigin&&(i.crossOrigin=""),i.alt="",this._getSessionToken().then(function(e){i.src=this.getTileUrl(t),o(null,i)}.bind(this)).catch(function(e){console.error(e),o(e)}),i},getAttribution:function(){return this.attribution},getTileUrl:function(e){return r.Util.template(r.TileLayer.Google.TILE_REQUEST,{z:e.z,x:e.x,y:e.y,sessionToken:this._sessionToken,GoogleTileAPIKey:this.options.GoogleTileAPIKey})},onAdd:function(e){e.on("moveend",this._updateAttribution,this),r.TileLayer.prototype.onAdd.call(this,e),this._needToRefreshToken=!0,this._refreshToken(),this._updateAttribution()},onRemove:function(e){e.off("moveend",this._updateAttribution,this),this._needToRefreshToken=!1,this._promise=null,e.attributionControl.removeAttribution(this.attribution),this.attribution=null,r.TileLayer.prototype.onRemove.call(this,e)},setKey:function(e){e&&this.options.GoogleTileAPIKey!==e&&(this.options.GoogleTileAPIKey=e,this._getSessionToken().then(function(){this.redraw()}.bind(this)).catch(function(e){console.log(e)}))},setLanguage:function(e){e&&this.options.language!==e&&(this.options.language=e,this._promise=null,this._getSessionToken().then(function(){this.redraw(),this._updateAttribution()}.bind(this)).catch(function(e){console.log(e)}))},setMapType:function(e){if(!e||-1===t.indexOf(e))throw new Error("'"+e+"' is an invalid mapType");this.options.imagery!==e&&(this.options.imagery=e,this._promise=null,this._getSessionToken().then(function(){this.redraw(),this._updateAttribution()}.bind(this)).catch(function(e){console.log(e)}))},setMapStyle:function(e){e&&this.options.mapStyle!==e&&(this.options.mapStyle=e,this._promise=null,this._getSessionToken().then(function(){this.redraw(),this._updateAttribution()}.bind(this)).catch(function(e){console.log(e)}))},setRegion:function(e){e&&this.options.region!==e&&(this.options.region=e,this._promise=null,this._getSessionToken().then(function(){this.redraw(),this._updateAttribution()}.bind(this)).catch(function(e){console.log(e)}))},_getAttributionUrl:function(){var e=this._map,t=this._tileZoom,o=e.getBounds().toBBoxString().split(",");return r.Util.template(r.TileLayer.Google.ATTRIBUTION_URL,{GoogleTileAPIKey:this.options.GoogleTileAPIKey,sessionToken:this._sessionToken,zoom:t,south:o[0],east:o[1],north:o[2],west:o[3]})},_makeGetRequest:function(e,t){e.open("GET",t,!0),e.send()},_updateAttribution:function(t){var o=this._map,i=this;o&&o.attributionControl&&this._getSessionToken().then(function(){i._exponentialTimeout=1e3;var e=new XMLHttpRequest;e.onreadystatechange=function(){clearTimeout(i._timer),4===this.readyState&&200===this.status?(o.attributionControl.removeAttribution(i.attribution),i.attribution=JSON.parse(this.responseText).copyright,o.attributionControl.addAttribution(i.attribution),t&&!t.target&&t(null,i.attribution)):4===this.readyState&&(i._exponentialTimeout>=i.options.requestTimeout?console.error("Attribution request unsuccessful.  Last request took more than "+i.options.requestTimeout/1e3+" seconds.  Giving up."):(console.error("Attribution request unsuccessful, retrying in "+i._exponentialTimeout/1e3+" seconds"),i._timer=setTimeout(function(){i._exponentialTimeout*=2,i._makeGetRequest(e,i._getAttributionUrl())},i._exponentialTimeout)))},i._makeGetRequest(e,i._getAttributionUrl())}.bind(this)).catch(function(e){t&&!t.target&&t(e),console.error("updateAttribution",e)})}}),r.tileLayer.google=function(e){return new r.TileLayer.Google(e)},o.exports=r.TileLayer.Google}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]);